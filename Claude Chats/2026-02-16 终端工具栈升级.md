---
tags:
  - terminal
  - cli
  - zsh
  - hammerspoon
  - rust
---

日期: 2026-02-16

## 概述

将 macOS 终端开发环境从传统工具栈迁移到高性能现代工具栈，大幅提升启动速度和使用体验。

## 工具替换

| 之前                       | 现在           | 说明                         |
| ------------------------ | ------------ | -------------------------- |
| iTerm2                   | Ghostty      | Zig 写的 GPU 加速终端            |
| oh-my-zsh + robbyrussell | Starship     | Rust 写的跨 shell prompt      |
| oh-my-zsh 框架             | 纯 zsh 配置     | 手动配置 bindkey/setopt/zstyle |
| nvm                      | fnm          | Rust 写的 Node 版本管理，启动几乎无感   |
| ls                       | eza          | 带颜色、git 状态、内置 tree         |
| cd                       | zoxide       | 智能目录跳转，模糊匹配                |
| grep                     | ripgrep (rg) | 超快文件内容搜索                   |
| find                     | fd           | 超快文件名搜索                    |
| cat                      | bat          | 带语法高亮的文件查看                 |

## 新增工具

- **Hammerspoon** — macOS 自动化工具（Lua 脚本），用来实现 Ghostty 下拉终端
- **fzf** — 通用模糊搜索，zoxide 的 `zi` 命令依赖它
- **zsh-autosuggestions** — 输入时灰色显示历史建议，按 `→` 补全
- **JetBrainsMono Nerd Font** — 支持 Starship 图标显示

## Hammerspoon 配置

实现了 Ghostty 下拉终端（Quake 风格）：
- **Hyper + M** — 切换 Ghostty 下拉窗口（屏幕上方 45% 高度）
- **Hyper + F** — 伪全屏（最大化但不进入 macOS 全屏 Space）
- 配置文件: `~/.hammerspoon/init.lua`
- macOS 原生全屏下无法覆盖，用 Hyper+F 伪全屏替代

## zshrc 清理

去掉了：
- oh-my-zsh 框架加载
- nvm（替换为 fnm）
- iTerm2 shell integration
- vpnon/vpnoff 函数

手动补回的 oh-my-zsh 功能：
- `bindkey '^[[A/B'` — 按前缀过滤历史（上下键）
- `zstyle matcher-list` — 大小写不敏感补全
- `zstyle menu select` — Tab 补全用方向键选择
- `setopt auto_cd` — 输目录名直接 cd
- `setopt correct` — 命令拼写纠正
- Git 别名（gst, gco, gp, gd, gpsup 等）

## Starship 配置

`~/.config/starship.toml`:
- 禁用 gcloud 模块（不显示邮箱）
- command_timeout 调至 1000ms（避免 fnm node 检测超时）

## 相关知识

- **Zig** — 2015 年出现的系统编程语言，和 C 同级性能但开发体验更好，Bun 和 Ghostty 都用它写的
- **Ghostty** — Mitchell Hashimoto（HashiCorp 创始人）开发，GPU 渲染 + 原生 UI
- Hammerspoon 需要辅助功能权限，设置开机自启后常驻后台（约十几 MB 内存）
